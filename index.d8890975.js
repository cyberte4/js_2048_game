var t={};class e{static gameStatus={idle:"idle",playing:"playing",win:"win",lose:"lose"};constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.grid=t,this.score=0,this.status=e.gameStatus.idle}getState(){return this.grid}getScore(){return this.score}getStatus(){return this.status}start(){this.status=e.gameStatus.playing,this.addRandomTile(),this.addRandomTile(),this.renderBoard()}restart(){this.grid=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status=e.gameStatus.idle,this.renderBoard()}addRandomTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.grid[e][s]&&t.push({row:e,col:s});if(0===t.length)return;let e=Math.floor(Math.random()*t.length),{row:s,col:i}=t[e];.9>Math.random()?this.grid[s][i]=2:this.grid[s][i]=4}renderBoard(){let t=document.querySelectorAll(".field-cell"),e=0;for(let s=0;s<4;s++)for(let i=0;i<4;i++){let r=t[e];r.classList="field-cell";let d=this.grid[s][i];0!==d?(r.classList.add(`field-cell--${d}`),r.textContent=d):r.textContent="",e++}}filterZero(t){return t.filter(t=>0!==t)}move(t){let e=this.filterZero([...t]);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t]);for(e=this.filterZero(e);e.length<4;)e.push(0);return e}moveLeft(){let t=!1;for(let e=0;e<4;e++){let s=this.grid[e],i=[...s];s=this.move(s),JSON.stringify(i)!==JSON.stringify(s)&&(t=!0),this.grid[e]=s}t&&this.addRandomTile(),this.checkWin(),this.checkLose(),this.renderBoard(),this.updateScore()}moveRight(){let t=!1;for(let e=0;e<4;e++){let s=this.grid[e],i=[...s];s.reverse(),(s=this.move(s)).reverse(),JSON.stringify(i)!==JSON.stringify(s)&&(t=!0),this.grid[e]=s}t&&this.addRandomTile(),this.checkWin(),this.checkLose(),this.renderBoard(),this.updateScore()}moveUp(){let t=!1;for(let e=0;e<4;e++){let s=[this.grid[0][e],this.grid[1][e],this.grid[2][e],this.grid[3][e]],i=[...s];s=this.move(s),JSON.stringify(i)!==JSON.stringify(s)&&(t=!0),this.grid[0][e]=s[0],this.grid[1][e]=s[1],this.grid[2][e]=s[2],this.grid[3][e]=s[3]}t&&this.addRandomTile(),this.checkWin(),this.checkLose(),this.renderBoard(),this.updateScore()}moveDown(){let t=!1;for(let e=0;e<4;e++){let s=[this.grid[0][e],this.grid[1][e],this.grid[2][e],this.grid[3][e]],i=[...s];s.reverse(),(s=this.move(s)).reverse(),JSON.stringify(i)!==JSON.stringify(s)&&(t=!0),this.grid[0][e]=s[0],this.grid[1][e]=s[1],this.grid[2][e]=s[2],this.grid[3][e]=s[3]}t&&this.addRandomTile(),this.checkWin(),this.checkLose(),this.renderBoard(),this.updateScore()}updateScore(){document.querySelector(".game-score").textContent=this.score}checkWin(){for(let t=0;t<4;t++)for(let s=0;s<4;s++)if(2048===this.grid[t][s])return document.querySelector(".message.message-win").classList.remove("hidden"),this.status=e.gameStatus.win,!0;return!1}checkLose(){if(this.status===e.gameStatus.lose)return!0;for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.grid[t][e]||e<3&&this.grid[t][e]===this.grid[t][e+1]||t<3&&this.grid[t][e]===this.grid[t+1][e])return!1;return document.querySelector(".message.message-lose").classList.remove("hidden"),this.status=e.gameStatus.lose,!0}}const s=new(t=e),i=document.querySelector(".button.start"),r=document.querySelector(".message.message-start"),d=document.querySelector(".message.message-win"),o=document.querySelector(".message.message-lose");i.addEventListener("click",()=>{s.getStatus()===t.gameStatus.idle||s.getStatus()===t.gameStatus.lose?(s.start(),r.classList.add("hidden"),i.textContent="Restart",i.classList.remove("start"),i.classList.add("restart")):(s.restart(),r.classList.remove("hidden"),d.classList.add("hidden"),o.classList.add("hidden"),s.score=0,s.updateScore(),i.textContent="Start",i.classList.remove("restart"),i.classList.add("start"))}),document.addEventListener("keyup",e=>{s.getStatus()===t.gameStatus.playing&&("ArrowLeft"===e.code&&s.moveLeft(),"ArrowRight"===e.code&&s.moveRight(),"ArrowUp"===e.code&&s.moveUp(),"ArrowDown"===e.code&&s.moveDown())});
//# sourceMappingURL=index.d8890975.js.map
