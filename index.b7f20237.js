!function(){var e,t,r={};function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function s(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var a=function(){var e;function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.grid=e,this.score=0,this.status=t.gameStatus.idle}return e=[{key:"getState",value:function(){return this.grid}},{key:"getScore",value:function(){return this.score}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status=t.gameStatus.playing,this.addRandomTile(),this.addRandomTile(),this.renderBoard()}},{key:"restart",value:function(){this.grid=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status=t.gameStatus.idle,this.renderBoard()}},{key:"addRandomTile",value:function(){for(var e=[],t=0;t<4;t++)for(var r=0;r<4;r++)0===this.grid[t][r]&&e.push({row:t,col:r});if(0!==e.length){var i=Math.floor(Math.random()*e.length),s=e[i],a=s.row,n=s.col;.9>Math.random()?this.grid[a][n]=2:this.grid[a][n]=4}}},{key:"renderBoard",value:function(){for(var e=document.querySelectorAll(".field-cell"),t=0,r=0;r<4;r++)for(var i=0;i<4;i++){var s=e[t];s.classList="field-cell";var a=this.grid[r][i];0!==a?(s.classList.add("field-cell--".concat(a)),s.textContent=a):s.textContent="",t++}}},{key:"filterZero",value:function(e){return e.filter(function(e){return 0!==e})}},{key:"move",value:function(e){for(var t=this.filterZero(s(e)),r=0;r<t.length-1;r++)t[r]===t[r+1]&&(t[r]*=2,t[r+1]=0,this.score+=t[r]);for(t=this.filterZero(t);t.length<4;)t.push(0);return t}},{key:"moveLeft",value:function(){for(var e=!1,t=0;t<4;t++){var r=this.grid[t],i=s(r);r=this.move(r),JSON.stringify(i)!==JSON.stringify(r)&&(e=!0),this.grid[t]=r}e&&this.addRandomTile(),this.checkWin(),this.checkLose(),this.renderBoard(),this.updateScore()}},{key:"moveRight",value:function(){for(var e=!1,t=0;t<4;t++){var r=this.grid[t],i=s(r);r.reverse(),(r=this.move(r)).reverse(),JSON.stringify(i)!==JSON.stringify(r)&&(e=!0),this.grid[t]=r}e&&this.addRandomTile(),this.checkWin(),this.checkLose(),this.renderBoard(),this.updateScore()}},{key:"moveUp",value:function(){for(var e=!1,t=0;t<4;t++){var r=[this.grid[0][t],this.grid[1][t],this.grid[2][t],this.grid[3][t]],i=s(r);r=this.move(r),JSON.stringify(i)!==JSON.stringify(r)&&(e=!0),this.grid[0][t]=r[0],this.grid[1][t]=r[1],this.grid[2][t]=r[2],this.grid[3][t]=r[3]}e&&this.addRandomTile(),this.checkWin(),this.checkLose(),this.renderBoard(),this.updateScore()}},{key:"moveDown",value:function(){for(var e=!1,t=0;t<4;t++){var r=[this.grid[0][t],this.grid[1][t],this.grid[2][t],this.grid[3][t]],i=s(r);r.reverse(),(r=this.move(r)).reverse(),JSON.stringify(i)!==JSON.stringify(r)&&(e=!0),this.grid[0][t]=r[0],this.grid[1][t]=r[1],this.grid[2][t]=r[2],this.grid[3][t]=r[3]}e&&this.addRandomTile(),this.checkWin(),this.checkLose(),this.renderBoard(),this.updateScore()}},{key:"updateScore",value:function(){document.querySelector(".game-score").textContent=this.score}},{key:"checkWin",value:function(){for(var e=0;e<4;e++)for(var r=0;r<4;r++)if(2048===this.grid[e][r])return document.querySelector(".message.message-win").classList.remove("hidden"),this.status=t.gameStatus.win,!0;return!1}},{key:"checkLose",value:function(){if(this.status===t.gameStatus.lose)return!0;for(var e=0;e<4;e++)for(var r=0;r<4;r++)if(0===this.grid[e][r]||r<3&&this.grid[e][r]===this.grid[e][r+1]||e<3&&this.grid[e][r]===this.grid[e+1][r])return!1;return document.querySelector(".message.message-lose").classList.remove("hidden"),this.status=t.gameStatus.lose,!0}}],function(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t.prototype,e),t}();t={idle:"idle",playing:"playing",win:"win",lose:"lose"},(e="gameStatus")in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t;var n=new(r=a),o=document.querySelector(".button.start"),d=document.querySelector(".message.message-start"),u=document.querySelector(".message.message-win"),c=document.querySelector(".message.message-lose");o.addEventListener("click",function(){n.getStatus()===r.gameStatus.idle||n.getStatus()===r.gameStatus.lose?(n.start(),d.classList.add("hidden"),o.textContent="Restart",o.classList.remove("start"),o.classList.add("restart")):(n.restart(),d.classList.remove("hidden"),u.classList.add("hidden"),c.classList.add("hidden"),n.score=0,n.updateScore(),o.textContent="Start",o.classList.remove("restart"),o.classList.add("start"))}),document.addEventListener("keyup",function(e){n.getStatus()===r.gameStatus.playing&&("ArrowLeft"===e.code&&n.moveLeft(),"ArrowRight"===e.code&&n.moveRight(),"ArrowUp"===e.code&&n.moveUp(),"ArrowDown"===e.code&&n.moveDown())})}();
//# sourceMappingURL=index.b7f20237.js.map
